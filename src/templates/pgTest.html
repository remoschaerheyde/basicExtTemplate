<div class="hy-comment-table-container lui-text-default">


    
     <table class="hy-comment-table">
        <thead ng-style="{'height': vm.tblHeaderHeight + 'px'}">
            <tr>
                <th class="hy-nonComment-col" ng-repeat="dimInfo in vm._dimensionsInfo track by $index" ng-style="{'height': vm.tblHeaderHeight + 'px'}">
                    <div class="hy-tbl-header-item-container">
                        <span class="lui-text-default">{{dimInfo.qGroupFallbackTitles[0]}}</span>
                    </div>
                </th>
                <th class="hy-nonComment-col" ng-repeat="measureInfo in vm._measureInfo track by $index" ng-style="{'height': vm.tblHeaderHeight + 'px'}">
                    <div class="hy-tbl-header-item-container">
                        <span class="lui-text-default">{{measureInfo.qFallbackTitle}}</span>
                    </div>
                </th>
                <th class="hy-comment-col" ng-style="{'width': vm.commentColWidth + 'px', 'height': vm.tblHeaderHeight + 'px'}">
                    <div class="hy-tbl-header-item-container">
                        <span class="lui-text-default">Comments</span>
                    </div>
                </th>
            </tr>
        </thead>
        <tbody ng-style="{'height': vm.tblBodyHeight + 'px'}">
            <tr ng-repeat="row in vm._matrixData track by $index" ng-init="outerRowIndex = $index">
                <td ng-repeat="cell in row track by $index" >
                    <!-- display row and measures -->
                    <div ng-if="$index !== vm.commentColIndex" class="hy-nonComment-col">
                        <div class="hy-nonComment-col-container">
                                <span>{{cell.qText}}</span>
                        </div>
                    </div>
                    <!-- display comments -->
                    <div ng-if="$index === vm.commentColIndex" ng-style="{'width': vm.commentColWidth + 'px'}">

                        <!--display comments small-->
                        <div class="hy-comment-display" ng-class="{'commentEditMode': commentEditMode}" ng-hide="vm.showEditForCell === outerRowIndex" 
                            ng-click="cell.qText !== '' || commentEditMode === true ? vm.showEditForCell = outerRowIndex:  vm.showEditForCell =-1 ; vm.textAreaComment = cell.qText; vm.testTransition = !vm.testTransition" ng-style="{'width': vm.commentColWidth}">
                            <span class="hy-comment-text"> {{cell.qText}}</span>
                            <span class="hy-comment-emtpy-div">.</span> 
                        </div>

                        <!-- display comments large -->
                        <div class="hy-comment-edit lui-dialog" ng-show="vm.showEditForCell === outerRowIndex">
                            <div class="hy-closeBtnContainer" ng-if="!commentEditMode">
                                    <span class="hy-comment-closeBtn lui-icon lui-icon--close" ng-click="vm.showEditForCell = -1" aria-hidden="true"></span>
                            </div>
                            
                            <div class="lui-dialog__header hy-comment-editCommentHeader" ng-if="commentEditMode">
                                <div class="lui-dialog__title">
                                    <span>Edit Comment</span>
                                    <span class="hy-comment-editCloseBtn lui-icon lui-icon--close" ng-click="vm.showEditForCell = -1" aria-hidden="true"></span>
                                </div>   
                            </div>
                            
                            <div class="hy-comment-editCommentBody lui-dialog__body" ng-style="{'width': vm.commentColWidth + 'px'}">
                                <textarea class="hy-comment-textarea lui-textarea" ng-readonly="!commentEditMode" ng-model="vm.textAreaComment" ng-style="{'width': vm.commentColWidth + 'px'}" spellcheck="false"></textarea>
                            </div>

                            <div class="lui-dialog__footer hy-comment-editCommentFooter" ng-if="commentEditMode">
                                <button class="lui-button lui-dialog__button" ng-click="vm.deleteComment(row); vm.showEditForCell = -1" ng-hide="cell.qText.length === 0">Delete comment</button>
                                <button class="lui-button lui-dialog__button" ng-click="vm.addOrUpdateComment(row, outerRowIndex); vm.showEditForCell = -1">
                                    <span ng-show="cell.qText.length === 0">Create new comment</span>
                                    <span ng-hide="cell.qText.length === 0">Update comment</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody>

        <tfoot class="hy-tbl-footer" ng-style="{'height': vm.tblFooterHeight + 'px'}">
            <tr>
                <td ng-style="{'height': vm.tblFooterHeight + 'px'}">
                        <div class="hy-tbl-footer-copyright-container" >
                            <span>&copy; 2018 Heyde Schweiz AG</span>
                        </div>
                </td>
                <td>
                    <div class="hy-editModeLabelContainer">
                        <span>Mode:</span>
                    </div>
                </td>
                <td>
                    <div class="hy-editModeSwitchContainer">
                            <div class="hy-editModeSwitch lui-switch">
                                <label class="lui-switch__label">
                                    <input ng-true-value="true" ng-false-value="false" ng-model="commentEditMode" type="checkbox" class="lui-switch__checkbox" aria-label="Label"/>                                <span class="lui-switch__wrap">
                                        <span class="lui-switch__inner"></span>
                                        <span class="lui-switch__switch"></span>
                                    </span>
                            </label>
                        </div>
                    </div>
                </td>    
                <td>
                    <div>
                        <span>{{ commentEditMode === true ? 'Edit': 'View'}}</span> 
                    </div>
                       
                </td>
            

            
            </tr>
        </tfoot>  

     </table>

 </div>        